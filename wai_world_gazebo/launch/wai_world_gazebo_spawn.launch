<?xml version="1.0" ?>

<launch>


	<!-- GLOBAL PARAMETERS -->
	<arg name="namespace_global" default="wai_world"/>
	<arg name="namespace_world" default="world"/>
    <arg name="world_name" default="worlds/empty.world"/>
	<arg name="tf_pub_interval" default="50.0"/>
	<arg name="rviz_frame_rate" default="20.0"/>



    <!-- LAUNCH GAZEBO (IN GLOBAL NAMESPACE) -->
    <arg name="paused" default="false"/>
    <arg name="extra_gazebo_args" default=""/>
    <arg name="recording" default="false"/>
    <arg name="headless" default="false"/>
    <arg name="debug" default="false"/>
    <arg name="physics" default="ode"/>
    <arg name="verbose" default="false"/>
    <arg name="output" default="screen"/>
    <arg name="respawn_gazebo" default="false"/>
    <!-- Set command line arguments -->
    <arg unless="$(arg paused)" name="command_arg1" value=""/>
    <arg     if="$(arg paused)" name="command_arg1" value="-u"/>
    <arg unless="$(arg recording)" name="command_arg2" value=""/>
    <arg     if="$(arg recording)" name="command_arg2" value="-r"/>
    <arg unless="$(arg verbose)" name="command_arg3" value=""/>
    <arg     if="$(arg verbose)" name="command_arg3" value="--verbose"/>
    <arg unless="$(arg debug)" name="script_type" value="gzserver"/>
    <arg     if="$(arg debug)" name="script_type" value="debug"/>
    <!-- Start Gazebo SERVER -->
    <param name="/use_sim_time" value="false"/> <!-- Parameter use_sim_time needs to be defined in ROOT namespace! -->
    <param name="gazebo/use_clock_frequency" value="true"/>
    <param name="gazebo/pub_clock_frequency" value="200"/>
    <param name="gazebo/enable_ros_network" value="true"/>
    <node name="gazebo" pkg="gazebo_ros" type="$(arg script_type)" respawn="$(arg respawn_gazebo)" output="$(arg output)" args="$(arg command_arg1) $(arg command_arg2) $(arg command_arg3) -e $(arg physics) $(arg extra_gazebo_args) $(arg world_name)" required="true"/>
    <!-- Start Gazebo CLIENT (GUI) -->
    <!--<node name="gazebo_gui" pkg="gazebo_ros" type="gzclient" respawn="false" output="$(arg output)" args="$(arg command_arg3)" required="true"/> -->



	<!-- Launch WORLD HELPER NODES (e.g., INPUT DEVICES) in own namespace -->
	<group ns="$(arg namespace_world)">

        <!-- Launch HELPER TFs -->
        <node pkg="tf" type="static_transform_publisher" name="pub_tf_world_wrt_map" args="0.0 0.0 0.0 0.0 0.0 0.0 world map $(arg tf_pub_interval)"/>
        <node pkg="tf" type="static_transform_publisher" name="pub_tf_world_wrt_odom" args="0.0 0.0 0.0 0.0 0.0 0.0 world odom $(arg tf_pub_interval)"/>

		<!-- Launch JOYPAD -->
        <!-- <node name="joy_node" pkg="joy" type="joy_node" args="_dev:=/dev/input/js0"/> -->
		<node name="joy_node" pkg="joy" type="joy_node" args="_dev:=/dev/input/js0 _dev_ff:=/dev/input/event18"/> <!-- WITH force feedback! -->

        <!-- Launch NLP (PICOVOICE) -->
        <node name="picovoice_driver_rhino" pkg="picovoice_driver" type="picovoice_driver_rhino" output="screen">
            <param name="access_key" value="insert_your_access_key_here!"/>
        </node>
        <node name="picovoice_driver_cheetah" pkg="picovoice_driver" type="picovoice_driver_cheetah" output="screen">
            <param name="access_key" value="insert_your_access_key_here!"/>
        </node>
        <node name="picovoice_driver_picollm" pkg="picovoice_driver" type="picovoice_driver_picollm" output="screen">
            <param name="access_key" value="insert_your_access_key_here!"/>
        </node>
        <node name="picovoice_driver_orca" pkg="picovoice_driver" type="picovoice_driver_orca" output="screen">
            <param name="access_key" value="insert_your_access_key_here!"/>
        </node>

		<!-- Launch AUDIO PLAY -->
		<include file="$(find audio_play)/launch/play.launch">
            <arg name="ns" value="/wai_world/world/audio_common"/>
        </include>

		<!-- Launch AUDIO CAPTURE for AUDIO-COMMUNICATION (currently enabled via trigger in server!)
		<include file="$(find audio_capture)/launch/capture.launch"/> -->

		<!-- Launch RVIZ (Setup framerate via script and start node) -->
	    <node pkg="wai_world_bringup" type="wai_world_rviz_set_frame_rate.bash" name="wai_world_rviz_set_frame_rate" output="screen" args="'Frame Rate: $(arg rviz_frame_rate)'"/>
		<node name="wai_world_rviz" pkg="rviz" type="rviz" required="true" args="-d $(find wai_world_bringup)/rviz/wai_world.rviz"/>

	</group>


</launch>
